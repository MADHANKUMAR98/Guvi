package presentation;

import pojo.Customer;
import service.CustomerService;
import service.CustomerServiceImpl;

import java.util.Scanner;

public class Presentation {
    private CustomerService customerService;
    private boolean isRegistered = false;
    private boolean isLoggedIn = false;

    public Presentation() {
        customerService = new CustomerServiceImpl();
    }

    public void present() {
        Scanner scan = new Scanner(System.in);
        while (true) {
            if (!isRegistered) {
                System.out.println("1. Register");
            }
            if (isRegistered && !isLoggedIn) {
                System.out.println("2. Login");
            }

            if (isLoggedIn) {
                System.out.println("3. Add Customer Details");
                System.out.println("4. View/Edit Customer Information");
                System.out.println("5. Record Electricity Usage");
                System.out.println("6. Generate Monthly Bill");
                System.out.println("7. View Bill History");
                System.out.println("8. Make a Payment");
                System.out.println("9. View Payment History");
                System.out.println("10. Admin - View Overdue Accounts");
                System.out.println("11. Exit");
            }

            System.out.print("Enter your option: ");
            int option = scan.nextInt();
            scan.nextLine(); // consume newline

            switch (option) {
                case 1: // User Registration
                    if (!isRegistered) {
                        System.out.print("Enter name: ");
                        String name = scan.nextLine();
                        System.out.print("Enter address: ");
                        String address = scan.nextLine();
                        System.out.print("Enter meter number: ");
                        String meterNumber = scan.nextLine();
                        System.out.print("Enter password: ");
                        String password = scan.nextLine();
                        String id = UUID.randomUUID().toString().substring(0, 8); // Shortened UUID
                        Customer newCustomer = new Customer(id, name, address, meterNumber, password);
                        customerService.addCustomer(newCustomer);
                        isRegistered = true;
                        System.out.println("Customer registered with ID: " + id);
                    } else {
                        System.out.println("You have already registered.");
                    }
                    break;
                case 2: // Customer Login
                    if (isRegistered && !isLoggedIn) {
                        System.out.print("Enter customer ID: ");
                        String loginId = scan.nextLine();
                        System.out.print("Enter password: ");
                        String loginPassword = scan.nextLine();
                        Customer customer = customerService.fetchCustomer(loginId);
                        if (customer != null && customer.getPassword().equals(loginPassword)) {
                            isLoggedIn = true;
                            System.out.println("Login successful.");
                        } else {
                            System.out.println("Invalid credentials.");
                        }
                    } else if (!isRegistered) {
                        System.out.println("Please register first.");
                    } else {
                        System.out.println("You are already logged in.");
                    }
                    break;
                // Other cases remain the same
                case 3: // Add Customer Details
                    if (isLoggedIn) {
                        // Code for adding customer details
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 4: // View/Edit Customer Information
                    if (isLoggedIn) {
                        // Code for viewing/editing customer information
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 5: // Record Electricity Usage
                    if (isLoggedIn) {
                        // Code for recording electricity usage
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 6: // Generate Monthly Bill
                    if (isLoggedIn) {
                        // Code for generating monthly bill
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 7: // View Bill History
                    if (isLoggedIn) {
                        // Code for viewing bill history
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 8: // Make a Payment
                    if (isLoggedIn) {
                        // Code for making a payment
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 9: // View Payment History
                    if (isLoggedIn) {
                        // Code for viewing payment history
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 10: // Admin - View Overdue Accounts
                    if (isLoggedIn) {
                        // Code for viewing overdue accounts
                    } else {
                        System.out.println("You need to log in first.");
                    }
                    break;
                case 11: // Exit
                    scan.close();
                    System.out.println("Exiting...");
                    return;
                default:
                    System.out.println("Invalid option. Please try again.");
            }
        }
    }
}
